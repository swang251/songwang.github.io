<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Song Wang</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://swang251.github.io/"/>
  <updated>2020-10-18T14:52:51.412Z</updated>
  <id>http://swang251.github.io/</id>
  
  <author>
    <name>Song Wang</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>The Jet-Drive Model</title>
    <link href="http://swang251.github.io/2020/09/30/The-Jet-Drive-Model/"/>
    <id>http://swang251.github.io/2020/09/30/The-Jet-Drive-Model/</id>
    <published>2020-09-30T22:20:20.000Z</published>
    <updated>2020-10-18T14:52:51.412Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Modeling the flute exitation is complex. There exiting two main models, i.e., <em>the jet-drive model</em> and <em>the discrete vortex model</em>. Let's talk about the jet-drive model for now.</p><a id="more"></a><h2 id="general-sound-generation-mechanisms">General Sound Generation Mechanisms</h2><p>The earliest attemps to study the flute-like instrument sound generation trace back to the work by Helmholtz (1877) and Rayleigh (1877), in their own celebrated books. The details within the instrument is more and more revealed recently thanks to the study by different researchers, like A. Hirschberg, B. Fabre, M. P. Verge, to name a few, even though there are still many puzzles left to be solved.</p><p>In general, the air blown out of the player's mouth passes through a flue channel, either a flue canal of a recorder or the one constrained by the player's lip, and forms a jet. The jet starts to oscillate with transverse perturbations contributed either by the acoustic field feed-back, the jet's intrinsic instability or the hydrodynamic direct feedback from the labium. Such an oscillation or perturbation will evolve and grow while convected by the jet from the flue channel exit toward the labium (a sharp edge). The jet will then hit the labium and apply a force on it, and the reacting force from the labium to the fluid acts as the acoustic source that sustains the acoustic oscillation inside the flute.</p><h2 id="the-flute-model">The Flute Model</h2><p>Based on the sound generation mechanisms, there are several key components need to be modeled and the most popular and easiest way to do that is modeling each component separately and lump them together. Such a lumped model is widely applied in different studies as well as synthesis, even though questioned by some researchers (Fabre et al. 2000).</p><p>Here is a list of the components to be modeled:</p><ul><li>Jet formation</li><li>Jet receptivity</li><li>Jet instability</li><li>Sound source</li><li>Vortices</li><li>Turbulence</li></ul><h2 id="the-jet-formation">The Jet Formation</h2><ul><li>The flow passes from the player's mouth or the organ's foot through the lip or flue channel. A jet is formed when the flow comes out of the channel.</li><li>The jet speed is determined by the pressure difference <span class="math inline">\(\Delta p_{jet} = p_f - p_w\)</span> across the flue channel and its profile depends on the geometry of the channel, where <span class="math inline">\(p_m\)</span> is the foot pressure and <span class="math inline">\(p_w\)</span> is the pressure at the window.</li><li>Sometimes people call <span class="math inline">\(p_f\)</span> the cavity pressure <span class="math inline">\(p_c\)</span> and <span class="math inline">\(p_w\)</span> can be called as mouth pressure <span class="math inline">\(p_m\)</span> (the mouth represents the window of the instrument instead of the player's mouth).</li><li>unsteady Bernoulli equation <span class="math display">\[\rho_0 l_c \dfrac{dU_j}{dt} + \dfrac{1}{2}\rho_0U_j^2 = p_f - p_w\]</span></li><li>The jet flow is a function of <span class="math inline">\(y\)</span>, written as <span class="math inline">\(U(y)\)</span>.</li><li>The volume flow rate is noted as <span class="math inline">\(Q_j\)</span></li><li>Part of the air will goes into the instrument <span class="math inline">\(Q_{in}\)</span> and the rest goes out <span class="math inline">\(Q_{out}\)</span>.<ul><li>The <span class="math inline">\(Q_{in}\)</span> sees the impedance (or admittance) of the pipe <span class="math inline">\(Z_p\)</span></li><li>The <span class="math inline">\(Q_{out}\)</span> sees the window impedance <span class="math inline">\(Z_w\)</span> which includes the radiation impedance as well as the end correction near the window.</li></ul></li></ul><h2 id="the-jet-profile">The Jet Profile</h2><ul><li>THE PROFILE OF the jet <span class="math inline">\(U(y)\)</span> depends on the upstream setup as well as the geometry of the channel. The most popular velocity profile is the Bickley velocity profile, defined as <span class="math display">\[U(y) = U_0\, \text{sech} ^2 (y/b)\]</span><ul><li>where half width of the profile <span class="math inline">\(b = 2h/5\)</span> is a Poseuille flow is assumed at the flue exit and <span class="math inline">\(h\)</span> is the flue channel height, and <span class="math inline">\(U_0\sim U_j\)</span> is the centerline velocity that is assimilated to the jet velocity <span class="math inline">\(U_j\)</span>.</li></ul></li></ul><h2 id="the-jet-oscillation">The Jet Oscillation</h2><ul><li>The jet starts to oscillate due to the disturbation by the acoustic transverse velocity as a result of the acoustic feedback.</li><li>The jet receptivity:</li><li>The receptivity is modeled by a parameter <span class="math inline">\(\eta(t)\)</span> defined as the jet lateral displacement when the jet arrives at the labium.</li><li>The contribution to <span class="math inline">\(\eta\)</span> mainly comes from the acoustic perturbation and the hydrodynamic feedback (Verge (1997)). Fletcher proposed a model to describe the receptivity and instability as <span class="math display">\[\eta = \dfrac{V_{ac}}{i\omega}(1-\cosh(\mu x))e^{-i\omega(t-x/c_p)}\]</span> which is then modified by Verge <span class="math display">\[\eta = \dfrac{V_{ac}}{i\omega}(1-\cosh(\alpha W))e^{-i\omega W/u}\]</span> where <span class="math inline">\(\mu\)</span> and <span class="math inline">\(u\)</span> is a function of the Strouhal number (Verge et al. 1997)</li><li>A simpler model is proposed by de la Cuadra in his thesis (2006) <span class="math display">\[\eta(t,x) = e^{\alpha_i x}\eta_0(t-x/c_p)\]</span> with <span class="math display">\[\dfrac{\eta_0}{h} = \dfrac{v_{ac}(t)}{U_j}\]</span><ul><li><span class="math inline">\(\alpha_i = \beta/h\)</span>: the empirical coefficient corresponding to the jet amplification</li><li><span class="math inline">\(c_p = \gamma U_j\)</span>: the empirical coefficient corresponding to the phase velocity of a perturbation along the jet.</li><li><span class="math inline">\(\beta \sim 0.5\)</span>: jet spatial amplification</li><li><span class="math inline">\(\gamma \sim 0.4\)</span>: the relative convection velocity</li></ul></li></ul><h2 id="the-jet-drive-model">The Jet-Drive Model</h2><ul><li>Coltman (1968, 1976) is the first one who proposed the jet drive model.</li><li>The fluctuating part of the inward and outward flow <span class="math inline">\(Q_{in}&#39;\)</span> and <span class="math inline">\(Q_{out}&#39;\)</span> are complementary to each other (<span class="math inline">\(Q_{in}&#39; = -Q_{out}&#39;\)</span>). (They are more commonly noted as <span class="math inline">\(Q_1\)</span> and <span class="math inline">\(Q_2\)</span>).</li><li>Assuming the air to be incompressible in between the two flow injection points of <span class="math inline">\(Q_{in}&#39;\)</span> and <span class="math inline">\(Q_{out}&#39;\)</span>, and apply the third Newton's law to the air mass, we get <span class="math display">\[\Delta p = -\dfrac{\rho \delta_d}{S_w}\dfrac{dQ_{in}&#39;}{dt} = -\dfrac{\rho \delta_d}{S_w}\dfrac{dQ_{in}}{dt}\]</span><ul><li><span class="math inline">\(S_w\)</span> is the window area</li><li><span class="math inline">\(\delta_d\)</span> is the effective acoustical &quot;distance&quot; between the two sources, calculated as <span class="math inline">\(\delta_d = 4\pi\sqrt{2hW}\)</span> as proposed by Verge (1994), where <span class="math inline">\(h\)</span> is the distance from the source to the tip of the labium.</li></ul></li><li><span class="math inline">\(Q_{in}\)</span> depends on the jet profile as well as the jet lateral displacement <span class="math inline">\(\eta(t)\)</span> <span class="math display">\[\displaystyle Q_{in}(t) = H_m\int_{-\infty}^{y_{off}-\eta(t)}U(y)dy\]</span><ul><li>where <span class="math inline">\(y_{off}\)</span> is the offset between the channel exit and the labium tip in <span class="math inline">\(y\)</span> axis</li><li><span class="math inline">\(H_w\)</span> the window width</li></ul></li></ul><h2 id="the-jet-resonator-interaction">The Jet-Resonator Interaction</h2><p>This might be the trickest part of the model and its slightly different from paper to paper.</p><ul><li><p>In general, the jet-resonator interaction is based on the <span class="math inline">\(\Delta p\)</span> from the jet-drive model and the admittance <span class="math inline">\(Y\)</span> of the resonator, while <span class="math inline">\(Y\)</span> includes the pipe admittance as well as the end correction around the embouchure.</p></li><li>In Auvray (2012, 2014)'s papers,<ul><li><span class="math inline">\(\Delta p = p^+ - p^-\)</span> where <span class="math inline">\(p^+\)</span> and <span class="math inline">\(p^-\)</span> corresponds to the pressure at the inward and outward sides of the source, and they share the same (acoustic) velocity <span class="math inline">\(v_{ac}\)</span>.</li><li><span class="math inline">\(Y = v_{ac} / \Delta p\)</span></li><li>It is not clear about the definition of <span class="math inline">\(v_{ac}\)</span> in this paper as it is also used as the transverse velocity to calculate the <span class="math inline">\(\eta_0\)</span>. But it seems like they are the same thing in Auvray's paper (2012) which is a little difficult to understand.</li><li>In de La Cuadra's thesis, v_{ac} is simply the acoustic velocity at the entrance of the pipe, corresponding to <span class="math inline">\(Q_p/S\)</span> in Verge's paper.</li></ul></li><li>In Verge (1997)'s papers,<ul><li><span class="math inline">\(P_p\)</span> and <span class="math inline">\(P_m\)</span> might correspond to <span class="math inline">\(p^+\)</span> and <span class="math inline">\(p^-\)</span> in Auvray's papeers, are the pressure at the entrance of the pipe and the pressure at the mouth/exit of the flue channel, respectively.</li><li>The pressure relationship is built as <span class="math display">\[p_p - p_m = -\dfrac{\rho_0\delta_{in}}{S_m}\dfrac{dQ_{in}}{dt} + \Delta p\]</span></li><li><span class="math inline">\(\Delta p = p_p - p_m + \dfrac{\rho_0\delta_{in}}{S_m}\dfrac{dQ_{in}}{dt} \neq p_p - p_m\)</span></li><li><span class="math inline">\(Q_p(0) = Q_{in}(0)\)</span></li><li><span class="math inline">\(Q_{in}\)</span> flow entering the <span class="math inline">\(\delta_{in}\)</span> part of the mouth end correction, <span class="math inline">\(Q_{1}\)</span> flow entering the pipe at the labium.</li><li>It should be safe to announce <span class="math inline">\(Q_p = Q_{in} = Q_1\)</span> based on the mass conservation.</li><li><span class="math inline">\(v_{ac}\)</span>, the transverse acoustic velocity is defined as <span class="math inline">\(v_m&#39;\)</span> in Verge's paper <span class="math display">\[v_m&#39; = \dfrac{2}{\pi}\dfrac{Q_p}{S_m} - \dfrac{0.38Q_1&#39;}{S_m},\]</span> where <span class="math inline">\(Q_1&#39; = Q_1 - \frac{1}{2}bHU_0\)</span></li></ul></li></ul><h2 id="the-jet-related-sound-source">The Jet-Related Sound Source</h2><ul><li></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Modeling the flute exitation is complex. There exiting two main models, i.e., &lt;em&gt;the jet-drive model&lt;/em&gt; and &lt;em&gt;the discrete vortex model&lt;/em&gt;. Let&#39;s talk about the jet-drive model for now.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Acoustics" scheme="http://swang251.github.io/categories/Acoustics/"/>
    
    
      <category term="Acoustics" scheme="http://swang251.github.io/tags/Acoustics/"/>
    
      <category term="Musical Acoustics" scheme="http://swang251.github.io/tags/Musical-Acoustics/"/>
    
      <category term="Wind Instrument" scheme="http://swang251.github.io/tags/Wind-Instrument/"/>
    
      <category term="Flute" scheme="http://swang251.github.io/tags/Flute/"/>
    
  </entry>
  
  <entry>
    <title>The role of the vortex - sound generative or dissipative?</title>
    <link href="http://swang251.github.io/2020/09/22/The-role-of-the-vortex/"/>
    <id>http://swang251.github.io/2020/09/22/The-role-of-the-vortex/</id>
    <published>2020-09-23T00:20:48.000Z</published>
    <updated>2020-09-23T02:13:13.982Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>We know that the vortex is generative based on the vortex sound theory. We also know that the vortex is dissipative at the end of the orifice. Is the vortex acoustic generative or dissipative?</p><a id="more"></a><h2 id="generative-vortices">Generative Vortices</h2><p>Let's start with the role of the vorticity in generating the sound.</p><ul><li>The vortex sound equation: <span class="math display">\[\begin{equation}\left(\dfrac{D}{Dt}\left(\dfrac{1}{c^2}\dfrac{D}{Dt} \right) - \dfrac{1}{\rho}\nabla\cdot(\rho\nabla) \right)B = \dfrac{1}{\rho}\nabla\cdot(\rho\boldsymbol{\omega}\times \boldsymbol{v})\end{equation}\]</span><ul><li><blockquote><p>Lighthill's equation can be recast in a form that emphasizes the prominent role of vorticity in the production of sound by taking the <strong>total enthalpy</strong> as the independent acoustic variable, in place of Lighthill's <span class="math inline">\(c_0^2(\rho-\rho_0)\)</span> -- <em>Howe, M. (Theory of Vortex Sound)</em></p></blockquote></li><li><a href="https://en.wikipedia.org/wiki/Enthalpy" target="_blank" rel="noopener">Enthalpy</a>: &quot;is defined as the sum of the system's internal energy and the product of its pressure and volume. The pressure-volume term expresses the work required to establish the system's physical dimensions, i.e. to make room for it by displacing its environment.&quot; <em>Enthalpy = internal energy + work required to establish the system's physical dimensions.</em></li><li><a href="https://en.wikipedia.org/wiki/Stagnation_enthalpy" target="_blank" rel="noopener">Total Enthalpy</a>: <span class="math inline">\(\displaystyle B = \int\dfrac{dp}{\rho} + \dfrac{1}{2}v^2\)</span></li><li>It is IMPORTANT to notice the following things:<ol type="1"><li>Originally proposed by Powell, the vortex sound equation is a reformation of the Lighthill's equation, which means it is applied to the <strong>unbounded homentropic flow</strong>.</li><li>It is based on the <strong>low Mach number approximation</strong></li><li>The term <span class="math inline">\(\nabla\cdot(\rho_0\boldsymbol{\omega}\times \boldsymbol{v})\)</span> is the <strong>dominant component of the Lighthill quadrupole</strong> <span class="math inline">\(\dfrac{\partial^2(\rho v_iv_j)}{\partial x_i\partial x_j}\)</span></li></ol></li></ul></li></ul><p>By the way,</p><ul><li>The equations in the wave equation format, i.e., Lighthill's equation and the vortex sound is derived by combining the continuity equation and the momentum equation.</li><li>Crocc's equation is simply the <strong>Crocco's form</strong> of the <strong>momentum equation</strong> with the emphasis on the vorticity.</li></ul><h2 id="dissipative-vortices">Dissipative Vortices</h2><p>Now, let's see why the vortices are acoustical dissipative as well.</p><p>In general, it is because</p><blockquote><p>acoustic energy is expended in the generation of vorticity at an edge or corner, and the mean flow convects away the vorticity into regions where it can no longer continue to interact significantly with the acoustic field, and where its kinetic energy is ultimately dissipated as heat.</p></blockquote><ul><li>Based on Howe, M. (1980), the absorbed acoustic energy is written as <span class="math display">\[\begin{equation}\displaystyle\pi_T = \int\rho_0\boldsymbol{\omega}\times\boldsymbol{u&#39;} \text{d}^3\boldsymbol{x} = -\int\varepsilon_{ij}\rho_0v_iv_j \text{d}^3\boldsymbol{x}\end{equation}\]</span><ul><li>where <span class="math inline">\(\boldsymbol{u&#39;}\)</span> is the <em>acoustic</em> particle velocity, <span class="math inline">\(\boldsymbol{v}\)</span> is the velocity and <span class="math inline">\(\varepsilon_{ij}\)</span> is the <em>acoustic</em> rate of the strain tensor</li></ul></li></ul><p>As you might have noticed, the term (1) <span class="math inline">\(\rho_0\boldsymbol{\omega}\times\boldsymbol{u&#39;}\)</span> resembles the term <span class="math inline">\(\rho_0\boldsymbol{\omega}\times\boldsymbol{v}\)</span> in the vortex sound equation, only by replacing <span class="math inline">\(\boldsymbol{v}\)</span> with the acoustic counterpart <span class="math inline">\(\boldsymbol{u}&#39;\)</span>. The term (2) <span class="math inline">\(\varepsilon_{ij}\rho_0v_iv_j\)</span> is also simply the product of the low Mach number Lighthill stress tensor <span class="math inline">\(\rho_0v_iv_j\)</span> and the acoustic rate of the strain tensor.</p><p>For both term (1) and (2), their counterparts in the generative case correspond to source term or RHS of the vortex sound equation and the Lighthill's equation, which describe the energy transfering from the fludic field to the acoustic field. Instead, term (1) and (2) is the other way round, the energy goes from the acoustic field to the fluidic field, or in other words, the acoustic energy is dissipated.</p><p>Actually, there is another way to understand quickly the dissipative characteristic of the vortex.</p><p>The velocity is related to the scalar potention <span class="math inline">\(\phi\)</span> and the stream function <span class="math inline">\(\boldsymbol{A}\)</span> <span class="math display">\[\begin{equation}\boldsymbol{v} = \nabla\phi + \nabla\times\boldsymbol{A}\end{equation}\]</span> where <span class="math inline">\(\nabla\phi = \boldsymbol{u}\)</span> is the irrotational field and the <span class="math inline">\(\nabla\times\boldsymbol{A}\)</span> is the solenoidal field.</p><p>The acoustic field is irrotational as <span class="math inline">\(u&#39; = \nabla\phi&#39;\)</span>. The vorticity field is solenoidal as <span class="math inline">\(\boldsymbol{\omega} = \nabla\times \boldsymbol{v} =\nabla\times \nabla\times \boldsymbol{v}\)</span>, since <span class="math inline">\(\nabla(\nabla\times f) = \nabla\times(\nabla f) = 0\)</span>.</p><p>When the kinetic energy is conserved, it simply flows from <span class="math inline">\(\nabla\times\boldsymbol{A}\)</span> (solenoidal/vorticity) to the <span class="math inline">\(\nabla\phi\)</span> (irrotational/acoustic) when the sound is generated and the other way round when the sound is dissipated.</p><h2 id="reference">Reference</h2><ul><li>[1] Howe, M. S., 2003, Theory of Vortex Sound, Cambridge University Press.</li><li>[2] Howe, M. S., 1980, “The Dissipation of Sound at an Edge,” Journal of Sound and Vibration, 70(3), pp. 407–411.</li><li>[3] Hirschberg, A., and Rienstra, S. W., 2004, “An Introduction to Aeroacoustics,” Eindhoven university of technology.</li><li>[4] Kühnelt, H., 2016, “Studying the Vortex Sound of Recorder- and Flute-like Instruments by Means of the Lattice Boltzmann Method and Helmholtz Decomposition,” University of Music and Performing Arts Vienna.</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;We know that the vortex is generative based on the vortex sound theory. We also know that the vortex is dissipative at the end of the orifice. Is the vortex acoustic generative or dissipative?&lt;/p&gt;
    
    </summary>
    
    
      <category term="Acoustics" scheme="http://swang251.github.io/categories/Acoustics/"/>
    
    
      <category term="Acoustics" scheme="http://swang251.github.io/tags/Acoustics/"/>
    
      <category term="Aero-acoustics" scheme="http://swang251.github.io/tags/Aero-acoustics/"/>
    
  </entry>
  
  <entry>
    <title>Update Hexo</title>
    <link href="http://swang251.github.io/2020/06/04/Update-Hexo/"/>
    <id>http://swang251.github.io/2020/06/04/Update-Hexo/</id>
    <published>2020-06-04T18:57:29.000Z</published>
    <updated>2020-06-04T20:20:32.009Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>At first, all I want is making the <a href="https://hexo.io/docs/asset-folders.html" target="_blank" rel="noopener">asset folder</a> work, then I tried to update hexo and met a series of problem and got them solved.</p><a id="more"></a><h2 id="conflication-of-hexo-generator-feed-and-hexo-3">Conflication of hexo-generator-feed and hexo 3</h2><h3 id="problem">Problem</h3><p>The first problem I met is shown as following <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Template render error: (unknown path) [Line 8, Column 25]</span><br><span class="line">  Error: Unable to call &#96;the return value of (posts[&quot;first&quot;])[&quot;updated&quot;][&quot;toISOString&quot;]&#96;, which is undefined or falsey</span><br></pre></td></tr></table></figure></p><h3 id="solution">Solution</h3><ul><li><p>I found a <a href="https://github.com/iissnan/theme-next-docs/issues/79" target="_blank" rel="noopener">issue</a> stating the same problem and <a href="https://github.com/iissnan/theme-next-docs/issues/79#issuecomment-287474959" target="_blank" rel="noopener">it was answered</a> that the plugin <code>hexo-generator-feed</code> and <code>hexo-generator-sitemap</code> is incompatible with <code>Hexo 3</code></p></li><li><p><a href="http://mixoo.cn/2020/02/08/hexo-tempalte-render-error/" target="_blank" rel="noopener">someone uninstalls these plugins to solve the problem</a> which doesn't work for me as <a href="https://github.com/tufu9441/maupassant-hexo" target="_blank" rel="noopener">maupassant-hexo</a> requires <code>hexo-generator-feed</code>.</p></li><li><p>As stated in the <a href="https://github.com/hexojs/hexo-generator-feed" target="_blank" rel="noopener"><code>hexo-generator-feed</code> repo</a>:</p><ul><li>Hexo 4: 2.x</li><li>Hexo 3: 1.x</li><li>Hexo 2: 0.x</li></ul></li><li><p>While my version in <code>package.json</code> is <code>"hexo": "^3.2.0"</code> and <code>"hexo-generator-feed": "^1.2.2"</code>. I am guessing that update <code>hexo</code> and <code>hexo-generator-feed</code> might help solve the problem.</p></li><li><p>And yes, when I have Hexo: 4.2.1 and hexo-generator-feed: 2.2.0, it is solved automatically.</p></li><li><p><code>npm rebuild node-sass --force</code>.</p></li></ul><h2 id="updating-node-and-hexo">Updating node and Hexo</h2><h3 id="updating-node.js">Updating Node.js</h3><ul><li>Newer version of <code>node.js</code> is needed for updating Hexo.</li><li>I forgot how I install my <code>node</code> originally. Here reinstalled it as follows<ol type="1"><li><code>which node</code></li><li><code>sudo rm -rf /usr/local/bin/node</code></li><li><code>sudo rm -rf /usr/loca/lib/node_modules/npm/</code></li><li><code>brew doctor</code></li><li><code>brew cleanup --prune-prefix</code></li><li><code>brew install node</code></li></ol></li><li><a href="https://stackoverflow.com/a/26919540/5798355" target="_blank" rel="noopener">Uninstall node.js on OSX</a>.</li></ul><h3 id="brew-link-node"><code>Brew link node</code></h3><ul><li>Then I try to make the link use the command <code>brew link node</code> which shed me the error <code>Error: Could not symlink include/node/common.gypi</code>.</li><li>The solution is <a href="https://discourse.brew.sh/t/mac-osx-homebrew-error-could-not-symlink-include-node-common-gypi/4717" target="_blank" rel="noopener">here</a><ol type="1"><li><code>sudo chown -R $(whoami) /usr/local/*</code>: change the owner of the files (root) to myself <code>$(whoami)</code>, otherwise, I couldn't rm <code>.gypi</code>, refer to <a href="https://discourse.brew.sh/t/mac-osx-homebrew-error-could-not-symlink-include-node-common-gypi/4717/5" target="_blank" rel="noopener">here</a> and <a href="https://gist.github.com/rcugut/c7abd2a425bb65da3c61d8341cd4b02d" target="_blank" rel="noopener">here</a></li><li><code>rm '/usr/local/include/node/config.gypi'</code></li><li><code>brew link --overwrite node</code></li></ol></li><li>Then I met the <a href="https://stackoverflow.com/questions/47306169/npm-version-is-giving-errormodule-js538-throw-err-error-cannot-find-modul" target="_blank" rel="noopener">problem</a> when using <code>npm</code>, giving me the error <code>modeule.js:538 throw err;</code><ul><li>This is <strong>solved</strong> by reinstalling the node using homebrew.</li></ul></li></ul><h3 id="update-hexo">Update hexo</h3><ul><li>modify the <code>package.json</code> and use the command <code>npm update</code> in the terminal.</li></ul><h2 id="downgrading-node">Downgrading node</h2><ul><li>When I try to deploy <code>hexo d</code>, it gave me the error <code>TypeError [ERR_INVALID_ARG_TYPE]: The "mode" argument must be integer. Received an instance of Object</code></li><li>This is because the <a href="https://zhuanlan.zhihu.com/p/136552969" target="_blank" rel="noopener">version of <code>Node.js</code> is too high</a> and we need to downgrade it.</li><li><a href="https://medium.com/@georgeenathomas/3-step-process-to-downgrade-node-version-using-homebrew-bc0b0a72ae27" target="_blank" rel="noopener">Downgrading through <code>brew</code></a><ol type="1"><li><code>brew unlink node</code></li><li><code>brew install node@12</code></li><li><code>brew link node@12</code>: failed</li><li><code>brew link --overwrite node@12</code></li></ol></li></ul><h2 id="about-node.js-npm">About Node.js &amp; NPM</h2><h3 id="node.js">Node.js</h3><ul><li><p><a href="https://en.wikipedia.org/wiki/Node.js" target="_blank" rel="noopener">Node.js wiki</a> &gt; Node.js is an open-source, cross-platform, <strong>JavaScript runtime environment</strong> that executes JavaScript code <strong>outside a web browser</strong>.</p></li><li><p><a href="https://nodejs.org/en/about/" target="_blank" rel="noopener">About Node.js</a>, JavaScript runtime, asynchronous event-driven, concurrency etc.</p></li><li><p><a href="https://www.tutorialspoint.com/nodejs/nodejs_introduction.htm" target="_blank" rel="noopener">tutorialspoint - introduction to Node.js</a></p></li><li><p><a href="https://www.sitepoint.com/node-js-is-the-new-black/" target="_blank" rel="noopener"><em>Node.js is the New Black</em> by Louis Simoneau in July 2010</a></p></li></ul><h3 id="npm">npm</h3><ul><li>node.js package manager.</li><li>write packages needed into <code>package.json</code> and run <code>npm install</code> or <code>npm update</code>. All the packages are inside <code>node_modules</code>.</li><li>An alternative: <a href="https://yarnpkg.com/" target="_blank" rel="noopener">yarn</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;At first, all I want is making the &lt;a href=&quot;https://hexo.io/docs/asset-folders.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;asset folder&lt;/a&gt; work, then I tried to update hexo and met a series of problem and got them solved.&lt;/p&gt;
    
    </summary>
    
    
      <category term="daily" scheme="http://swang251.github.io/categories/daily/"/>
    
    
      <category term="Hexo" scheme="http://swang251.github.io/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>Manage Your Own Package in Spacemacs</title>
    <link href="http://swang251.github.io/2020/05/29/Manage-Your-Own-Package-in-Spacemacs/"/>
    <id>http://swang251.github.io/2020/05/29/Manage-Your-Own-Package-in-Spacemacs/</id>
    <published>2020-05-29T19:53:05.000Z</published>
    <updated>2020-05-29T20:27:42.796Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>How to manage your own package or the one your forked in Spacemacs? The answer is the <em>layer</em>. <a id="more"></a></p><h2 id="create-your-layer">Create your layer</h2><ul><li><code>M-x</code> + <code>configuration-layer/create-layer</code></li><li>select <code>~/.spacemacs.d</code></li><li>The layer <code>&lt;layerName&gt;</code> is created with <code>packages.el</code> and/or <code>README.org</code> (depends on your choice).</li><li>add your layer <code>&lt;layerName&gt;</code> into the variable <code>dotspacemacs-configuration-layers</code> in <code>~/.spacemacs.d/init.el</code></li></ul><h2 id="manage-your-packages-in-packages.el">Manage your packages in <code>packages.el</code></h2><ul><li><code>packages.el</code> contains a list of packages and their configuaration functions (init, post-init, etc...)</li><li>Add your packages into <code>packages.el</code> following the grammar in the <a href="https://develop.spacemacs.org/doc/LAYERS.html#packagesel" target="_blank" rel="noopener">documentation</a><ul><li><p>Spacemacs supports different recipes to install a package. For managing our own package, we need to maintain it locally instead of remotely. This way, you would be able to debug and make sure it is working before your push it.</p></li><li><p>For local multi-file package, one has to use <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(package-name :location (recipe :fetcher local))</span><br></pre></td></tr></table></figure></p></li><li><p>Initialize the package by adding <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(defun layerName/init-packageName ()</span><br><span class="line">    (use-package packageName</span><br><span class="line">  :init)</span><br><span class="line">  )</span><br></pre></td></tr></table></figure></p></li><li><p><strong>IMPORTANT:</strong> Multi-file local package is not supported yet byf the stable version Spacemaces. To make it work, one has to follow the <a href="https://github.com/syl20bnr/spacemacs/pull/8718" target="_blank" rel="noopener">issues #8718</a> and fix the corresponding files. Otherwise, clone the develop branch.</p></li></ul></li><li>Local packages should reside at <code>&lt;layerName&gt;/local/&lt;packageName&gt;</code>, git repository can be created within this folder.</li><li>See <a href="https://develop.spacemacs.org/doc/DOCUMENTATION.html#configuration-layers" target="_blank" rel="noopener">Configuration layers</a> for more details</li></ul><h2 id="ref">Ref</h2><ul><li><a href="http://book.emacs-china.org/#orgheadline88" target="_blank" rel="noopener">Spacemacs Rocks Season 2</a></li><li><a href="https://emacs-china.org/t/hack-package/2716" target="_blank" rel="noopener">Discussion in Emacs China</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;How to manage your own package or the one your forked in Spacemacs? The answer is the &lt;em&gt;layer&lt;/em&gt;.
    
    </summary>
    
    
      <category term="Emacs" scheme="http://swang251.github.io/categories/Emacs/"/>
    
    
      <category term="Emacs" scheme="http://swang251.github.io/tags/Emacs/"/>
    
  </entry>
  
  <entry>
    <title>How do I use Zotero?</title>
    <link href="http://swang251.github.io/2020/01/07/How-do-I-use-Zotero/"/>
    <id>http://swang251.github.io/2020/01/07/How-do-I-use-Zotero/</id>
    <published>2020-01-07T15:30:24.000Z</published>
    <updated>2020-05-07T02:01:54.942Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>I used Endnote as my first reference management software when I started my master study. I also tried a little bit Mendeley and saw how well it is intrinsically coupled Elsevier publications and the PDF editor. However, I finally decided to use <a href="https://www.zotero.org/" target="_blank" rel="noopener">Zotero</a> mainly because it is an open-source software and is more flexible.</p><a id="more"></a><h2 id="workflow">Workflow</h2><ul><li>Read the <a href="https://www.zotero.org/support/start" target="_blank" rel="noopener">documentation</a></li><li><a href="https://www.zotero.org/support/adding_items_to_zotero" target="_blank" rel="noopener">Adding Items to Zotero</a><ul><li>We need to install the <em>Zotero Connector</em> for Chrome, Firefox, or other web browsers.</li><li>We need to launch the Zotero desktop application before he could save items to Zotero.</li></ul></li><li><a href="https://www.zotero.org/support/attaching_files#adding_files" target="_blank" rel="noopener">Adding files to items</a><ul><li>the <em>Zotero Connector</em> provides an automatic routine to save the PDF to the Zotero.</li><li>However, I personally prefer to "manually" save the PDFs using <a href="#zotfile">ZotFile</a>.</li></ul></li><li>Organize your PDFs: see <a href="#pdf-organization">below</a></li><li>Adding notes to items: here I list two options<ul><li><a href="https://daringfireball.net/projects/markdown/syntax" target="_blank" rel="noopener">Markdown</a>: use <a href="#markdown-here"><em>Markdown Here</em></a></li><li><a href="https://orgmode.org/" target="_blank" rel="noopener">Org mode</a>: use <a href="#org-mode"><em>.org</em></a> attachments</li></ul></li></ul><h2 id="attachementspdfs-organization">Attachements/PDFs Organization</h2><p>There are two options here to manage your attachments: <a href="https://www.zotero.org/support/attaching_files#stored_files_and_linked_files" target="_blank" rel="noopener">stored files and linked files</a>.</p><h3 id="save-and-sync-the-attachements-in-your-zotero-library">Save and sync the attachements in your Zotero library</h3><ul><li>All your attachments will be stored in <code>${Zotero}\storage</code> (set your Data Directory Location in <code>preference</code>-<code>Advanced</code>-<code>Files and Folders</code>), since everything is coded and automatically organized, you will see a series of folders likely named as <code>2NEHBKP9</code>.</li><li>Zotero allows you to sync your files/attachements in My Library. All the attachements you put under the items can be synchronized to the <a href="https://www.zotero.org/storage" target="_blank" rel="noopener">Zotero Storage</a> or your own WebDAV.<ul><li>You can modify it by going to the <code>preference</code> <span class="math inline">\(\rightarrow\)</span> <code>Sync</code> <span class="math inline">\(\rightarrow\)</span> <code>Settings</code> <span class="math inline">\(\rightarrow\)</span> <code>File Syncing</code></li><li>Check/uncheck the <code>Sync attachement files in My Library using</code></li><li>Select <code>Zotero</code> or <code>WebDAV</code>.</li><li>If you select <code>WebDAV</code>, you will need to provide your account infomation.<ul><li>Here is how it works using <a href="https://www.jianguoyun.com" target="_blank" rel="noopener">Jianguoyun</a>: <a href="http://help.jianguoyun.com/?p=2064" target="_blank" rel="noopener">坚果云第三方应用授权WebDAV开启方法</a></li></ul></li></ul></li></ul><p><strong>However, there are two limitation of the this method:</strong></p><ul><li>Zotero storage is not free</li><li>The cloud storage you are using, like <a href="https://help.dropbox.com/installs-integrations/third-party/webdav-or-ftp" target="_blank" rel="noopener">Dropbox, doesn't support WebDAV</a></li></ul><p>So here is another way to organize and sync your attachements.</p><h3 id="save-the-links-to-the-pdfs-in-your-zotero-library.">Save the links to the PDFs in your Zotero library.</h3><p>Zotero allows you to store the link to files in My Library.</p><ul><li>Set the set your <a href="https://www.zotero.org/support/preferences/advanced#linked_attachment_base_directory" target="_blank" rel="noopener">base directory</a> by going to the <code>Preference</code> <span class="math inline">\(\rightarrow\)</span> <code>Advanced</code> <span class="math inline">\(\rightarrow\)</span> <code>Files and Folders</code> <span class="math inline">\(\rightarrow\)</span> <code>Linked Attachment Base Directory</code>. This way, links are stored as the relative path in your library so that is easier when you access the linked files on different computers.</li><li>Use ZotFile for a linked-file workflow</li></ul><h3 id="zotfile">ZotFile</h3><blockquote><p><a href="http://zotfile.com/" target="_blank" rel="noopener">ZotFile</a> is a Zotero plugin to manage your attachments: automatically rename, move, and attach PDFs (or other files) to Zotero items, sync PDFs from your Zotero library to your (mobile) PDF reader (e.g. an iPad, Android tablet, etc.) and extract annotations from PDF files.</p></blockquote><ul><li>ZotFile Preferences <span class="math inline">\(\rightarrow\)</span> Renaming Rules</li><li>ZotFile Preferences <span class="math inline">\(\rightarrow\)</span> General Setting<ul><li>Source Folder for Attaching New Files: makes it easier to attach newly downloaded files.<ul><li>Download PDF <span class="math inline">\(\rightarrow\)</span> select the paper item <span class="math inline">\(\rightarrow\)</span> right click: Attach New File (ZotFile)</li></ul></li><li>Location of Files<ul><li>Attach stored copy of file(s)</li><li>Custom Location:<ul><li>Use subfolder defined by <code>/%F</code></li></ul></li></ul></li></ul></li></ul><h2 id="note-management">Note Management</h2><h3 id="markdown-here">Markdown Here</h3><blockquote><p><a href="https://markdown-here.com/" target="_blank" rel="noopener">Markdown Here</a> is an extension for Chrome, Firefox, Safari, Opera, Thunderbird, and Postbox.</p></blockquote><ul><li>One can <a href="https://github.com/jlegewie/markdown-here#building-the-extension-bundles" target="_blank" rel="noopener">build the extension bundle</a> from the source code and generate the <code>.xpi</code> file for Zotero</li><li>Then in Zotero, go to Tools <span class="math inline">\(\rightarrow\)</span> Add-on <span class="math inline">\(\rightarrow\)</span> Install Add-on From File...</li><li>When you edit the note, go to File <span class="math inline">\(\rightarrow\)</span> Markdown Toggle or use the hotkey <code>Ctrl+Alt+M</code> to switch back and forth between the plain and the rendered text</li></ul><h3 id="org-mode">Org-mode</h3><blockquote><p><a href="https://orgmode.org/" target="_blank" rel="noopener">Org mode</a> is for keeping notes, maintaining TODO lists, planning projects, and authoring documents with a fast and effective plain-text system.</p></blockquote><p>I started to use Org mode in 2018 and gradually fall in love with it. To me, there is no substitute of Org mode. I tried different markdown softwares like Quiver, Joplin, etc. They are good, (especially the Joplin) but they cannot replace Org mode. Everything is foldable in Org mode which makes it much easier to explore and organize the documents. Also, considering how painful it is to keep notes in the Zotero-note, even with the <a href="https://markdown-here.com/" target="_blank" rel="noopener">Markdown Here</a>, I decided to find a way out to use Org mode for writing reading summaries and notes which can be integrated with Zotero.</p><ul><li>create a <code>noteTemplate.org</code></li><li>Everytime you will add the note by<ul><li>Right click on items <span class="math inline">\(\rightarrow\)</span> Add Attachment <span class="math inline">\(\rightarrow\)</span> Attach Stored Copy of File <span class="math inline">\(\rightarrow\)</span> Select the <code>noteTemplate.org</code></li><li>Right click on <code>.org</code> file under the item <span class="math inline">\(\rightarrow\)</span> Rename File from Parent Metadata</li></ul></li></ul><h3 id="zotxt">Zotxt</h3><blockquote><p><a href="https://gitlab.com/egh/zotxt-emacs" target="_blank" rel="noopener">zotxt-emacs</a> works with zotxt to provide an Emacs integration with Zotero, allowing you to manage citation keys for pandoc markdown documents as well as org mode links to items in your Zotero collection. - Check <a href="http://www.mkbehr.com/posts/a-research-workflow-with-zotero-and-org-mode/" target="_blank" rel="noopener">this article</a> about using Zotxt</p></blockquote><h2 id="other">Other</h2><h3 id="better-bibtex-for-zotero">Better BibTeX for Zotero</h3><blockquote><p><a href="https://retorque.re/zotero-better-bibtex/" target="_blank" rel="noopener">Beter BibTex (BBT)</a> is an extension for Zotero and Juris-M that makes it easier to manage bibliographic data, especially for people authoring documents using text-based toolchains (e.g. based on LaTeX / Markdown). - Automatically exports the <code>.bib</code> file and organizes the citation key.</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;I used Endnote as my first reference management software when I started my master study. I also tried a little bit Mendeley and saw how well it is intrinsically coupled Elsevier publications and the PDF editor. However, I finally decided to use &lt;a href=&quot;https://www.zotero.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Zotero&lt;/a&gt; mainly because it is an open-source software and is more flexible.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Research Daily" scheme="http://swang251.github.io/categories/Research-Daily/"/>
    
    
      <category term="Emacs" scheme="http://swang251.github.io/tags/Emacs/"/>
    
      <category term="Zotero" scheme="http://swang251.github.io/tags/Zotero/"/>
    
      <category term="Org-mode" scheme="http://swang251.github.io/tags/Org-mode/"/>
    
  </entry>
  
  <entry>
    <title>Building a Personal Palabos Git Repository</title>
    <link href="http://swang251.github.io/2019/12/17/Building-a-Personal-Palabos-Git-Repository/"/>
    <id>http://swang251.github.io/2019/12/17/Building-a-Personal-Palabos-Git-Repository/</id>
    <published>2019-12-17T06:05:22.000Z</published>
    <updated>2020-06-14T00:42:16.866Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://palabos.unige.ch/" target="_blank" rel="noopener">Palabos</a> just released a new version (v2.1r0) and pushed everything on <a href="https://gitlab.com/unigespc/palabos" target="_blank" rel="noopener">GitLab</a>. This is something that all the Palabos community used to looking forward and makes it easier for the users to get official updates and contribute their own code. Personally, I would like to build my own Palabos version with in-house developed code while keeping updated from the official one. In this post, I am trying to talk about the Git workflow I use, which is mainly based on the <a href="https://www.atlassian.com/git/tutorials/comparing-workflows/feature-branch-workflow" target="_blank" rel="noopener">Feature Branch Workflow</a> and the <a href="https://nvie.com/posts/a-successful-git-branching-model/" target="_blank" rel="noopener">Git Workflow</a>. <img src="/images/20191217/PalabosGitFlow.jpg" /> <a id="more"></a></p><h2 id="requirements">Requirements</h2><p>The workflow has to at least fulfill the following requirements.</p><ul><li>Allow private development: researchers might want to develop and test their own algorithms on Palabos. Some of the algorithms may not have been published yet. It is therefore reasonable to keep the repository private.</li><li>Allow easy merge requests: This is about implementations of published algorithms or some complement functions/dataProcessors that should definitely be contributed to the official Palabos version.</li><li>Allow updates from the UniGeSPC/Palabos: keep the personal repository up-to-date with the official one.</li><li>Allow bug fixed both committed to the private and the official repositories.</li></ul><h2 id="forked-project">Forked Project</h2><ul><li>Firstly, <a href="https://docs.gitlab.com/ee/gitlab-basics/fork-project.html" target="_blank" rel="noopener">fork</a> the project <a href="https://gitlab.com/unigespc/palabos" target="_blank" rel="noopener">UniGeSPC/palabos</a>. After this, you could find the folked project under <em>Projects--&gt;Your Projects</em></li><li>Private Project? :<ul><li><strong>Initial solution</strong><em>: Go to your forked Palabos project. You can make it private by set the Project visibility to </em>private<em>. (Go to </em>Setting --&gt; General --&gt; Visibility, project features, permissions --&gt; Project visibility*)</li><li>The above solution simply doesn't work as GitLab (at least the project with CI/CD) requires the forked project to be public or you have to be a member of the <code>UniGeSPC/Palabos</code>, in order to automatically merge the branch.</li><li>The <strong>Current Possible Solution</strong> (I haven't tried it myself) would be:<ul><li>forked from <code>UniGeSPC/palabos</code> as a public repository under the namespace A</li><li>Create A Group B (with the namespace B)</li><li>For your <code>A/palabos</code> into namespace B as <code>B/palabos</code> as a private repository.</li></ul></li></ul></li></ul><h2 id="branches">Branches</h2><p>There are four kinds of branches:</p><h3 id="master-branch">Master branch</h3><p>The <strong>master</strong> branch is simply used to save a copy of the <strong>UniGeSPC/palabos/master</strong>. Whenever this is a new release/update from the upstream, it should be merged to the <strong>master</strong> branch which is then merged to the <strong>develop</strong> branch.</p><p>As our own Palabos project is forked from the <strong>UniGeSPC/palabos</strong>, when we first clone the GitLab repository, our <strong>master</strong> branch should be synchronized with the <strong>UniGeSPC/palabos/master</strong>.</p><p>In order to track the official Palabos project, we need to add the <strong>UniGeSPC/palabos</strong> as the upstream <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git remote add upstream https:&#x2F;&#x2F;gitlab.com&#x2F;unigespc&#x2F;palabos.git</span><br></pre></td></tr></table></figure> The upstream repository is shown when typing <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git remote -v</span><br></pre></td></tr></table></figure> As only the master branch of the upstream repository matters, I modified my <em>.git/config</em> so that whenever I call <code>git fetch</code>, it only fetches the <strong>master</strong> branch instead of all branches. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[remote &quot;upstream&quot;]</span><br><span class="line">        url &#x3D; https:&#x2F;&#x2F;gitlab.com&#x2F;unigespc&#x2F;palabos.git</span><br><span class="line">        fetch &#x3D; +refs&#x2F;heads&#x2F;master:refs&#x2F;remotes&#x2F;upstream&#x2F;master</span><br></pre></td></tr></table></figure></p><p>When there is a new release in the upstream, fetch it and merge it into <strong>master</strong> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git fetch upstream master</span><br><span class="line">$ git checkout master</span><br><span class="line">$ git merge upstream&#x2F;master</span><br><span class="line">$ git push origin master</span><br></pre></td></tr></table></figure> The <strong>master</strong> branch is then merged to the <strong>develop</strong> branch that is introduced later. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout develop</span><br><span class="line">$ git merge --no-ff master</span><br><span class="line">$ git push origin develop</span><br></pre></td></tr></table></figure></p><h3 id="develop-branch">Develop branch</h3><p>The <strong>develop</strong> branch is used for the development, including new features or algorithms. It is initially branched off from the <strong>master</strong> branch <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout -b develop master</span><br></pre></td></tr></table></figure></p><p>However, it may never be merged back to <strong>master</strong>. Instead, whenever <strong>master</strong> gets an update from the upstream, it should be merged to <strong>develop</strong> branch. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout develop</span><br><span class="line">$ git merge --no-ff master</span><br><span class="line">$ git push origin develop</span><br></pre></td></tr></table></figure> Remember here we always use the flag <code>--no-ff</code> to avoid fast-forward merge.</p><blockquote><p>The --no-ff flag causes the merge to always create a new commit object, even if the merge could be performed with a fast-forward. This avoids losing information about the historical existence of a feature branch and groups together all commits that together added the feature.</p></blockquote><h3 id="feature-branch">Feature branch</h3><p>The <strong>feature</strong> branch is used for both algorithm implementations and new functions/dataProcessors. It can be used for implementing both published and unpublished algorithms. The <strong>feature</strong> branch has a name convention <strong>feature-</strong>*. Whenever starting a new <strong>feature</strong>, it should be branched off from either the <strong>master</strong> branch or the <strong>develop</strong> branch.</p><p>When you want to implement an algorithm that would be contributed to the upstream Palabos repository, you should branch off the <strong>master</strong> branch: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout -b feature-DESCRIPTION master</span><br></pre></td></tr></table></figure> Otherwise, you should branch off the <strong>develop</strong> branch: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout -b feature-DESCRIPTION develop</span><br></pre></td></tr></table></figure></p><p>When the development of a new feature is done and tested, it should be merged to the <strong>develop</strong> branch. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout develop</span><br><span class="line">$ git merge --no-ff feature-DESCRIPTION</span><br><span class="line">$ git push origin develop</span><br></pre></td></tr></table></figure></p><p>If you want to <a href="https://gitlab.com/unigespc/palabos/blob/master/CONTRIBUTING.md" target="_blank" rel="noopener">contribute</a> this new feature to Palabos, you can create a <a href="https://docs.gitlab.com/ee/gitlab-basics/add-merge-request.html" target="_blank" rel="noopener"><code>merge request</code></a>.</p><p>You can also delete this branch once it is merged to both the <strong>develop</strong> branch and the official Palabos. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git branch -d feature-DESCRIPTION</span><br></pre></td></tr></table></figure></p><h3 id="bugfix-branch">bugFix branch</h3><p><strong>bugFix</strong> is used to fix bugs. It is suggested to open an issue for each bug your find. It could then be branched off from <strong>develop</strong> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout -b bugFix-issueX develop</span><br></pre></td></tr></table></figure> Once the bug is fixed, it should be merged back to the <strong>develop</strong> branch <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout develop</span><br><span class="line">$ git merge --no-ff bugFix-issueX</span><br><span class="line">$ git push origin develop</span><br></pre></td></tr></table></figure> However, the Palabos Group might also fix the bug in the upstream branches if you don't create a <code>merge request</code> for your <strong>bugFix</strong> branch. If this happens, you might have to solve the conflict manually when you fetch <strong>upstream/master</strong> into the local <strong>master</strong> and then merged to the <strong>develop</strong>.</p><h2 id="cicd">CI/CD</h2><p>The palabos repository has CI/CD to make it easier for integrating and testing the codes from different contributors. In general:</p><ul><li>GitLab CI/CD is configured by a file called <code>.gitlab-ci.yml</code>. You can find it in the palabos root directory.</li><li><code>.gitlab-ci.yml</code> defines the <strong>pipelines</strong> to be done.</li><li><strong><a href="https://docs.gitlab.com/ee/ci/pipelines/index.html" target="_blank" rel="noopener">Pipelines</a></strong> is composed of<ul><li><strong>jobs</strong>: i.e., what to do (compiling, testing, etc.),</li><li><strong>Stages:</strong>: i.e., when to do.</li></ul></li><li>Jobs are excuted by <strong><a href="https://docs.gitlab.com/ee/ci/runners/README.html" target="_blank" rel="noopener">Runners</a></strong></li></ul><p>I am totally new to CI/CD but only few things we need to do in order to make a successful merge request:</p><ul><li><a href="https://docs.gitlab.com/ee/ci/runners/README.html" target="_blank" rel="noopener">Configuring GitLab Runner</a>: under project --&gt; <strong>Settings</strong> --&gt; <strong>CI/CD</strong> --&gt; <strong>Runners</strong> --&gt; <strong>Ennable shared Runners</strong>.</li><li>Then done! Once you've pushed your code to the repository, the pipeline will be automatically run.</li></ul><h2 id="conclusion">Conclusion</h2><p>Generally, this framework should work for most of our daily development and usage based on Palabos. My main doubt now is about the <strong>master</strong> branch. As it does nothing but saving a copy of the upstream, it seems reasonablbe to remove it. Everytime we see an new release from the upstream, the <strong>upstream/master</strong> could be directly merged in to the <strong>develop</strong> branch. However, the <strong>master</strong> branch is still kept for now to make the structure clearer.</p><p>Even though the workflow is not perfect, it allows us to maintain a customized Palabos while keeping the repository up-to-date with the upstream official Palabos. It is also easy to contribute to Palabos if you want. The flow diagram showed at the beginning is made based on <a href="https://nvie.com/posts/a-successful-git-branching-model/" target="_blank" rel="noopener">Vincent Driessen</a>'s template. Don't be hesitate to leave a message if you have any comments or suggestions. Thank you.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://palabos.unige.ch/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Palabos&lt;/a&gt; just released a new version (v2.1r0) and pushed everything on &lt;a href=&quot;https://gitlab.com/unigespc/palabos&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;GitLab&lt;/a&gt;. This is something that all the Palabos community used to looking forward and makes it easier for the users to get official updates and contribute their own code. Personally, I would like to build my own Palabos version with in-house developed code while keeping updated from the official one. In this post, I am trying to talk about the Git workflow I use, which is mainly based on the &lt;a href=&quot;https://www.atlassian.com/git/tutorials/comparing-workflows/feature-branch-workflow&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Feature Branch Workflow&lt;/a&gt; and the &lt;a href=&quot;https://nvie.com/posts/a-successful-git-branching-model/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Git Workflow&lt;/a&gt;. &lt;img src=&quot;/images/20191217/PalabosGitFlow.jpg&quot; /&gt;
    
    </summary>
    
    
      <category term="Palabos" scheme="http://swang251.github.io/categories/Palabos/"/>
    
    
      <category term="Palabos" scheme="http://swang251.github.io/tags/Palabos/"/>
    
      <category term="Git" scheme="http://swang251.github.io/tags/Git/"/>
    
  </entry>
  
  <entry>
    <title>Palabos Immersed Boundary-Lattice Boltzmann Method</title>
    <link href="http://swang251.github.io/2019/06/12/Palabos-Immersed-Boundary-Lattice-Boltzmann-Method/"/>
    <id>http://swang251.github.io/2019/06/12/Palabos-Immersed-Boundary-Lattice-Boltzmann-Method/</id>
    <published>2019-06-12T14:31:43.000Z</published>
    <updated>2019-06-12T21:23:41.447Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>The immersed boundary method (IBM) is proposed by Peskin in 1972 in his Ph.D. thesis and then is widely used for complex boundaries and moving boundary problems. IBM is applied in the context of lattice Boltzmann method (LBM) for the first time in 2004 by Feng and Michaelides (Feng and Michaelides, J. Comput. Phys, 2004). People also call such combination immersed boundary-lattice Boltzmann method (IB-LBM). In Palabos, different off-lattice methods have been implemented, including the Filippo-Hanel method, the Guo-Zheng-Shi method, the Bouzidi method and also the IBM.</p><a id="more"></a><p>In Palabos, there is a demo showing how to use the IBM to solve the moving wall problems (<em>example/showCases/movingWall</em>). As one can notice, in Palabosv2.0r0, only 3D IBM is implemented and the corresponding implementaions can be found in</p><ul><li><em>src/offLattice/immersedWalls3D.h</em></li><li><em>src/offLattice/immersedWalls3D.hh</em></li></ul><p>Here I will discuss only how the method used in the showCase works.</p><p>In the moving wall case, the multi direct-forcing IB-LBM proposed by Inamuro (2012) is used. Two main function are used:</p><ul><li><code>instantiateImmersedWallData(vertices, areas, container)</code> for the wall boundary instantiation,</li><li><code>inamuroIteration(parameters)</code> for the main IBM iteration.</li></ul><h3 id="instantiateimmersedwalldata">InstantiateImmersedWallData</h3><p><code>instantiateImmersedWallData</code> is a function wrapper for the functional <code>instantiateImmersedWallData3D</code> where the boundary data is stored in a container block called <code>ImmersedWallData3D</code>.</p><h3 id="inamuroiteration">InamuroIteration</h3><p><code>inamuroIteration</code> is a function wrapper for the functional <code>InamuroIteration3D</code> which implements the IB-LBM algorithm following Inamuro (2012). In Inamuro's paper, there are 5 steps (from Step 0-5) in the iterative procedure and it iterate from Step 1 to Step 4. In Palabos, the iteration is implemented with a slighly different procedure.</p><ul><li><code>for (neighboring) {averageJ += W*nextJ;}</code> corresponds to Eq 2.22 (<em>Step -1</em>) and Eq. 2.28 (<em>Step 3.</em>) and the <span class="math inline">\(\mathbf{j}_l(\mathbf{X}_k)\)</span> is calculated instead of <span class="math inline">\(\mathbf{u}_l(\mathbf{X}_k)\)</span>;</li><li><code>for (vertices) {deltaG[i] = area[i]*(wallVelocity-averageJ);}</code> calculates the <span class="math inline">\(g_l(\mathbf{X}_k)\)</span> in <em>Step 0</em> and the last term of the RHS in Eq. 2.29, <em>Step 4</em>;</li><li><code>for (vertices) {g[i] += deltaG[i];}</code> (incompressible model), does the Eq. 2.29 in <em>Step. 4</em>;</li><li><code>for (neighboring) {nextJ += tau*W*deltaG[i];}</code> corresponds to <em>Step 1</em> and <em>Step 2</em> for spreading the force for correct the velocity at the Eulerian grid points. We can take it as substituting <span class="math inline">\(\mathbf{g}_l(\mathbf{x})\)</span> in Eq. 2.27 by Eq. 2.26.</li></ul><p>In the main function in <em>movingWall.cpp</em>, the iteration time depends on <code>param.ibIter</code>.</p><h4 id="n.b.">N.B.</h4><ul><li>The loop for neighboring starts range from -1 to 2. This is because the <code>plint</code> in the line <code>Array&lt;plint,3&gt; intPos ((plint)vertex[0], (plint)vertex[1], (plint)vertex[2])</code> floors the vertex point to the nearest smaller position.</li><li>Still don't understand how the <code>tau</code> in <code>nextJ += tau*W*deltaG[i]</code> helps calculate the moment.</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;The immersed boundary method (IBM) is proposed by Peskin in 1972 in his Ph.D. thesis and then is widely used for complex boundaries and moving boundary problems. IBM is applied in the context of lattice Boltzmann method (LBM) for the first time in 2004 by Feng and Michaelides (Feng and Michaelides, J. Comput. Phys, 2004). People also call such combination immersed boundary-lattice Boltzmann method (IB-LBM). In Palabos, different off-lattice methods have been implemented, including the Filippo-Hanel method, the Guo-Zheng-Shi method, the Bouzidi method and also the IBM.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Palabos" scheme="http://swang251.github.io/categories/Palabos/"/>
    
    
      <category term="Palabos" scheme="http://swang251.github.io/tags/Palabos/"/>
    
      <category term="LBM" scheme="http://swang251.github.io/tags/LBM/"/>
    
      <category term="CFD" scheme="http://swang251.github.io/tags/CFD/"/>
    
  </entry>
  
  <entry>
    <title>Digital Audio Signal Processing Lecture 6 (Notes)</title>
    <link href="http://swang251.github.io/2019/02/12/Digital-Audio-Signal-Processing-Lecture-6/"/>
    <id>http://swang251.github.io/2019/02/12/Digital-Audio-Signal-Processing-Lecture-6/</id>
    <published>2019-02-13T00:33:47.000Z</published>
    <updated>2020-02-21T18:55:32.751Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Notes of Digital Audio Signal Processing, Lecture 6. <a id="more"></a></p><h3 id="inverse-system">Inverse System</h3><ul><li><span class="math inline">\(y=\mathcal{T}\{x\}\)</span> and <span class="math inline">\(x = \mathcal{T_i}\{y\}\)</span>, where <span class="math inline">\(\mathcal{TT_i} = \mathcal{T_iT} = \mathbf{I}\)</span></li><li><span class="math inline">\(h*h_i = h_i*h = \delta\)</span></li><li><strong>E.g.</strong>, michrophone with a flare that is a high-pass system, needs an inverse system to get rid of the HP effect.</li><li><strong>E.g.</strong>, <span class="math inline">\(h[n]=u[n]\)</span> (accumulator) <span class="math inline">\(\leftrightarrow\)</span> <span class="math inline">\(h_i[n]=\delta[n]-\delta[n-1]\)</span>, where <span class="math inline">\(h*h_i = \delta\)</span></li><li>Infinite impulse response <span class="math inline">\(\longleftrightarrow\)</span> finite impulse response, where the stability needs to be checked when inversion is from finite IR to infinite IR.</li><li><span class="math inline">\(power \propto amplitude^2\)</span><ul><li>Power dB = <span class="math inline">\(10\log_{10}(\dfrac{p}{p_0}) = 20\log_{10}(\dfrac{a}{a_0})\)</span></li><li>Amplitude dB = <span class="math inline">\(5\log_{10}(\dfrac{p}{p_0}) = 10\log_{10}(\dfrac{a}{a_0})\)</span></li></ul></li></ul><h3 id="frequency-response-of-lti-system">Frequency Response of LTI System</h3><ul><li><span class="math inline">\(p_{f_0}[n] = e^{2\pi jf_0 n}\)</span> is the eigenvector of a filter</li><li>Eigenvalue &amp; eigenvector of LTI system<ul><li><span class="math display">\[ \begin{align} y[n] &amp;= h*p_{f_0} = \sum\limits_{k\in \mathbb{Z}}h[k]p_{f_0}[n-k] \\      &amp;= \sum\limits_{k\in \mathbb{Z}}h[k]e^{2\pi jf_0 (n-k)} \\      &amp;= e^{2\pi jf_0 n}\sum\limits_{k\in \mathbb{Z}}h[k]e^{-2\pi jf_0k} \\      &amp;= p_{f_0}[n]H(f_0) \end{align}\]</span></li><li>where <span class="math inline">\(p_{f_0}\)</span> is the eigenvector and <span class="math inline">\(H(f_0)\)</span> is the eigenvalue.</li></ul></li></ul><h3 id="notable-notes">Notable notes</h3>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Notes of Digital Audio Signal Processing, Lecture 6.
    
    </summary>
    
    
      <category term="DSP" scheme="http://swang251.github.io/categories/DSP/"/>
    
    
      <category term="Lecture Notes (DASP)" scheme="http://swang251.github.io/tags/Lecture-Notes-DASP/"/>
    
  </entry>
  
  <entry>
    <title>Digital Audio Signal Processing Lecture 5 (Notes)</title>
    <link href="http://swang251.github.io/2019/02/05/Digital-Audio-Signal-Processing-Lecture-5/"/>
    <id>http://swang251.github.io/2019/02/05/Digital-Audio-Signal-Processing-Lecture-5/</id>
    <published>2019-02-05T23:00:52.000Z</published>
    <updated>2020-02-21T17:45:35.918Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Notes of Digital Audio Signal Processing, Lecture 5. <a id="more"></a></p><h3 id="convolution-and-multiplication">Convolution and multiplication</h3><ul><li><span class="math inline">\(Z(f)=X(f)Y(f)\leftrightarrow z=x*y\)</span></li><li><span class="math inline">\(Z(f)=X(f)*Y(f)\leftrightarrow z=xy\)</span></li><li>Application in Source-Filter model</li></ul><h3 id="parsevals-theorem"><a href="https://en.wikipedia.org/wiki/Parseval%27s_theorem" target="_blank" rel="noopener">Parseval's theorem</a></h3><p><span class="math display">\[\sum\limits_{n=-\infty}^\infty x^2[n]= \dfrac{1}{2\pi}\int_{-\pi}^{\pi}|X(e^{j\hat{\omega}})|^2\text{d}\hat{\omega}=\int_{-\frac{1}{2}}^{\frac{1}{2}}|X(f)|^2\text{d}f,\]</span> where the <span class="math inline">\(|X(f)|^2\)</span> is called the power spectral <strong>density</strong> which is with respect to frequency.</p><ul><li>To prove:<ul><li>Given signal and its DTFT <span class="math inline">\(x\leftrightarrow X\)</span></li><li>For the time reversed version of <span class="math inline">\(x\)</span>, <span class="math inline">\(y[n] = x[-n] \leftrightarrow Y(f)=\overline{X}(f)\)</span></li><li>For signal <span class="math inline">\(z\)</span> whose DTFT is defined as <span class="math inline">\(Z(f)=X(f)Y(f) = X(f)\overline{X}(f)\)</span>. <span class="math inline">\(z=x*y\)</span></li><li>In time domain: <span class="math inline">\(z[n]=\sum\limits_{k\in\mathbb{Z}}x[k]y[n-k] = \sum\limits_{k\in\mathbb{Z}}x[k]x[k-n]\)</span>, where <span class="math inline">\(\sum\limits_{k\in\mathbb{Z}}x[k]x[k-n]\)</span> is the <a href="https://en.wikipedia.org/wiki/Autocorrelation" target="_blank" rel="noopener">autocorrelation</a>. When <span class="math inline">\(n=0\)</span>, <span class="math display">\[\begin{equation}z[0]=\sum_\limits{k\in\mathbb{Z}}x^2[k]\label{Parseval1}\end{equation}\]</span>.</li><li>Taking the inverse DTFT: <span class="math inline">\(z[n] = \int_{-\frac{1}{2}}^{\frac{1}{2}}Z(f)e^{2\pi jfn}\text{d}f = \int_{-\tfrac{1}{2}}^{\tfrac{1}{2}}X(f)Y(f)e^{2\pi jfn}\text{d}f\)</span>. When <span class="math inline">\(n=0\)</span>, <span class="math display">\[\begin{equation}z[0]=\int_{-\frac{1}{2}}^{\frac{1}{2}}|X(f)|^2\text{d}f\label{Parseval2}\end{equation}\]</span>.</li><li>Eq. <span class="math inline">\(\eqref{Parseval1}\)</span> = Eq. <span class="math inline">\(\eqref{Parseval2}\)</span>.</li></ul></li></ul><h3 id="symmetry-properties-of-signal-and-related-spectral-properties.">Symmetry properties of signal and related spectral properties.</h3><ul><li>Even: <span class="math inline">\(x_e[n]=x_e[-n]\)</span></li><li>Odd: <span class="math inline">\(x_o[n]=-x_o[-n]\)</span></li><li>properties:<ul><li><span class="math inline">\(x_e\bot x_o\)</span>, (<span class="math inline">\(\sum x[n]y[n]=0\)</span>, dot product equals zero)</li><li><span class="math inline">\(\text{odd}\times\text{even} = \text{even}\)</span></li></ul></li><li>For any signal, it could be decomposed as into an even signal and an odd signal, meaning, <span class="math inline">\(x[n] = x_e[n]+x_o[n]\)</span>, where <span class="math inline">\(x_e[n] = \frac{x[n]+x[-n]}{2}\)</span> and <span class="math inline">\(x_o[n] = \frac{x[n]-x[-n]}{2}\)</span></li><li>Apply it into Fourier transform <span class="math display">\[ \begin{align}    X(f) &amp;= \sum\limits_{n\in\mathbb{Z}}x[n]e^{-2\pi jfn}\\         &amp;= \sum\limits_{n\in\mathbb{Z}}(x_e[n]+x_o[n])(\cos 2\pi fn - j \sin2\pi fn)\\         &amp;= \sum\limits_{n\in\mathbb{Z}}(x_e[n]\cos2\pi fn - jx_o[n]\sin2\pi fn),\\ \end{align}\]</span> where <strong>the <span class="math inline">\(\Re{\{X(f)\}}\)</span> is even and the <span class="math inline">\(\Im{\{X(f)\}}\)</span> is odd. </strong><ul><li>So a real spectrum means the even signal and a pure imaginary spectrum corresponds to a odd signal.</li></ul></li></ul><h3 id="frequency-shift-and-modulation">Frequency shift and modulation</h3><ul><li><span class="math inline">\(z=xp_{f_0}\)</span> (<span class="math inline">\(z[n]=x[n]e^{2\pi jf_0n}\)</span>)</li><li>Its Fourier transform: <span class="math inline">\(Z(f) = X*P_{f_0}=X(f-f_0)\)</span>, where <span class="math inline">\(P_{f_0}(f)=\delta(f-f_0)=\delta_{f_0}(f)\)</span></li><li><strong>Periodic in one domain</strong> means <strong>evenly spaced in the other domain</strong>.</li><li><a href="https://en.wikipedia.org/wiki/Dirac_comb" target="_blank" rel="noopener">Dirac comb</a></li></ul><h3 id="derivative-of-a-spectrum">Derivative of a Spectrum</h3><ul><li><span class="math display">\[\begin{align}    \dfrac{\text{d} X(f)}{\text{d} f}        &amp;= \frac{\text{d} \sum\limits_{n\in\mathbb{Z}}x[n]e^{-2\pi jfn}}{\text{d} f}\\       &amp;= -2\pi j \sum\limits_{n\in\mathbb{Z}}nx[n]e^{-2\pi jfn}\end{align}\]</span></li><li>Application: <strong>gain</strong><ul><li><span class="math inline">\(x[n] \rightarrow y[n] = g[n]x[n]\)</span>, where <span class="math inline">\(g[n] = a+bn\)</span> is a gain, linearly evolves over time.</li><li><span class="math inline">\(y[n]=ax[n]+b(nx[n])\)</span> <span class="math inline">\(\leftrightarrow\)</span> <span class="math inline">\(Y(f) = aX(f)+\frac{bj}{2\pi}\frac{\text{d} X(f)}{\text{d}f}\)</span>.</li><li><strong>gain in time</strong> <span class="math inline">\(\leftrightarrow\)</span> <strong>derivative in spectrum</strong></li><li><strong>Further explanation?</strong></li></ul></li></ul><h3 id="time-scaling">Time scaling</h3><ul><li><span class="math inline">\(y(t)=x(\alpha t)\)</span> <span class="math inline">\(\leftrightarrow\)</span> <span class="math inline">\(Y = \frac{1}{\alpha}X(\frac{f}{\alpha})\)</span></li></ul><h3 id="discrete-time-system">Discrete-time system</h3><ul><li>A system: <span class="math inline">\(y=\mathcal{T}\{x\}\)</span> or <span class="math inline">\(y[n] = \mathcal{T}\{x\}[n]\)</span></li><li>Like delay (<span class="math inline">\(y[n]=x[n-n_0]\)</span>), square (<span class="math inline">\(y[n]=x^2[n]\)</span>), moving max, threshold and so on.</li><li><strong>Distortion - Chebyshev polynomials?</strong></li><li><strong>Noise reduction need distortion?</strong></li></ul><h4 id="classes">classes</h4><ul><li>memoryless: only the current time (no past, no future samples);</li><li>linear: additivity and scalability</li><li>time invariance: the system propcessing doesn't depends on when you apply it (<span class="math inline">\(y[n-{n_0}]=\mathcal{T}\{x[n-{n_0}]\}\)</span>)</li><li>Stability: <span class="math inline">\(\lVert x\rVert &lt; B_x\)</span> <span class="math inline">\(\leftrightarrow\)</span> <span class="math inline">\(\lVert y\rVert &lt; B_y\)</span>.<ul><li>delay: stable</li><li>amplifier: stable</li><li>accumulator: depends</li></ul></li></ul><h3 id="linear-time-invariant-system-leftrightarrow-filter">Linear Time-Invariant system <span class="math inline">\(\leftrightarrow\)</span> filter</h3><ul><li>A filter is a LTI system.</li><li><span class="math inline">\(x[n] = \sum\limits_{k\in\mathbb{Z}}x[k]\delta[n-k]\)</span> <span class="math display">\[\begin{align}  y[n] &amp;= \mathcal{T}\{x\}[n] \\       &amp;= \mathcal{T}\{\sum\limits_{k\in\mathbb{Z}}x[k]\delta_k[n]\}\\       &amp;= \sum\limits_{k\in\mathbb{Z}}\mathcal{T}\{x[k]\delta_k[n]\}\\       &amp;= \sum\limits_{k\in\mathbb{Z}}\{x[k]\mathcal{T}\{\delta_k[n]\}\} \quad \text{applying linearities}\\       &amp;= \sum\limits_{k\in\mathbb{Z}}x[k]h_k[n],  \end{align}\]</span> where <span class="math inline">\(h_k=\mathcal{T}\{\delta_k\}\)</span> is the <strong>impulse reponse</strong>.</li><li><span class="math inline">\(y=x*h\)</span></li><li><span class="math inline">\(Y=XH\)</span>, where <span class="math inline">\(H\)</span> is the Fourier transform of <span class="math inline">\(h\)</span> and is the frequency response.</li><li><a href="https://en.wikipedia.org/wiki/Toeplitz_matrix#Discrete_convolution" target="_blank" rel="noopener">Toeplitz matrix and convolution</a></li><li>For convoluion: <span class="math inline">\(N_y = N_x+N_h-1\)</span></li><li>Properties:<ul><li>Stability: depends on <span class="math inline">\(h\)</span>, meaning the bound of <span class="math inline">\(\sum\limits_{k\in\mathbb{Z}}|h[n-k]|\)</span></li><li>causality: <span class="math inline">\(h[n-k]=0\)</span> for <span class="math inline">\(k\leq n\)</span>.</li><li>memoryless: <span class="math inline">\(h[k]=0\)</span> when <span class="math inline">\(k\neq 0\)</span></li></ul></li></ul><h3 id="notable-notes">Notable notes</h3><ul><li>Energy: the accumulated version of the power <span class="math inline">\(x^2[n]\)</span></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Notes of Digital Audio Signal Processing, Lecture 5.
    
    </summary>
    
    
      <category term="DSP" scheme="http://swang251.github.io/categories/DSP/"/>
    
    
      <category term="Lecture Notes (DASP)" scheme="http://swang251.github.io/tags/Lecture-Notes-DASP/"/>
    
  </entry>
  
  <entry>
    <title>Simulation Routine, and Code/Result Management across Laptop and Cluster</title>
    <link href="http://swang251.github.io/2019/01/30/Commands-and-Routine-of-Simulation-on-Graham-Compute-Canada-Cluster/"/>
    <id>http://swang251.github.io/2019/01/30/Commands-and-Routine-of-Simulation-on-Graham-Compute-Canada-Cluster/</id>
    <published>2019-01-30T10:41:19.000Z</published>
    <updated>2019-05-31T20:33:58.636Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>For my research involving the lattice Boltzmann method, I normally run most of the simulation on the cluster <a href="https://docs.computecanada.ca/wiki/Graham" target="_blank" rel="noopener">GRAHAM</a> of Compute Canada. It is boring and inconvenient to manage the code and the simulation results across my own laptop and the cluster. But still, I am building up my own way to manage everything and try to make it as easy as possible. Here I briefly note down how I organize my codes using Cmake and Git, and what is the routine of running simulation on the cluster.</p><a id="more"></a><h3 id="softwaretool-list">Software/Tool List</h3><ul><li><a href="https://git-scm.com/" target="_blank" rel="noopener">Git</a> (version control)</li><li><a href="https://bitbucket.org/" target="_blank" rel="noopener">Bitbucket</a> (remote repository storage)</li><li><a href="https://www.sourcetreeapp.com/" target="_blank" rel="noopener">Sourcetree</a> (Git GUI)</li><li><a href="https://cmake.org/" target="_blank" rel="noopener">CMake</a> (cross-platform building software)</li><li><a href="https://www.jetbrains.com/clion/" target="_blank" rel="noopener">CLion</a> (C++ IDE)</li><li><a href="https://www.gnu.org/software/emacs/" target="_blank" rel="noopener">Emacs</a> (Text editor for code editing on the cluster)</li><li><a href="https://slurm.schedmd.com/overview.html" target="_blank" rel="noopener">Slurm</a> (job scheduler used by Compute Canada clusters)</li><li><a href="https://www.globus.org/" target="_blank" rel="noopener">Globus</a> (file transfer)</li><li><a href="https://www.paraview.org/" target="_blank" rel="noopener">Paraview</a> (result visualization)</li></ul><h3 id="login-and-version-control">Login and Version Control</h3><ul><li>For convenience, I make an alias of the ssh connection called <code>graham</code>. Details could be check in my <a href="https://swang251.github.io/2018/10/04/Passwordless-SSH-connection-to-a-Cluster/">previous blog</a>.</li><li>I am using <a href="https://git-scm.com/" target="_blank" rel="noopener">Git</a> and <a href="https://bitbucket.org/" target="_blank" rel="noopener">Bitbucket</a> for version control.</li></ul><h3 id="file-structure">File Structure</h3><ul><li>For the LBM simulation, I got my projects stored in the folder <em>lbm</em> and the Palabos library in <em>palabos</em>, make sure they are in the same directory level.</li><li>Each project is named as the case short name + dimension. For example, I have <em>aeolianToneCylinder2D</em> and <em>ductRadiation2DAxisymmetric</em>.</li><li>In each project, the file structure is shown below. It includes<ul><li><em>main.cpp</em>: the main c++ file,</li><li><em>CMakeLists.txt</em>: the CMake configuration file,</li><li><em>./laptop-cmake-build-debug/</em>: the workspace folder for the laptop, including the<ul><li>CMAKE workspace files,</li><li>Makefile,</li><li>excutable file,</li><li>.xml simulation setup file,</li></ul></li><li><em>./cluster-cmake-build-debug/</em>: the workspace folder for the cluster,<ul><li>CMAKE workspace files,</li><li>Makefile,</li><li>excutable file,</li><li>.xml simulation setup file ,</li><li>.sh file for submitting batch jobs,</li></ul></li><li><em>./Analysis/</em>: the folder for the simulation results and the analysis scripts.<ul><li>.m matlab script</li><li>.vtk for visualization</li><li>.dat for simulaiton <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">aeolianToneCylinder2D</span><br><span class="line">+-- main.cpp</span><br><span class="line">+-- CMakeLists.txt</span><br><span class="line">+-- laptop-cmake-build-debug</span><br><span class="line">|   +-- aeolianToneCylinder2D.xml</span><br><span class="line">+-- cluster-cmake-build-debug</span><br><span class="line">|   +-- aeolianToneCylinder2D.xml</span><br><span class="line">|   +-- aeolianToneCylinder2D.sh</span><br><span class="line">+-- Analysis</span><br><span class="line">|   +-- *.m</span><br><span class="line">|   +-- ResultFolders</span><br></pre></td></tr></table></figure></li></ul></li></ul></li></ul><h3 id="build-and-compilation">Build and Compilation</h3><ul><li>I am using <a href="https://cmake.org/" target="_blank" rel="noopener">CMake</a> for cross-platform project building (MacOS for my laptop and Linux on the cluster).</li><li>Each platform owns its own workspace folder, i.e., <em>./laptop-cmake-build-debug</em> for the laptop and <em>./cluster-cmake-build-debug</em> for the cluster.</li><li>The project on the laptop is built and debugged through CLion which is straight forward.</li><li>On the cluster end, go to the folder <em>./cluster-cmake-build-debug</em> and use the command <code>cmake ../</code> to build the project. Then, use <code>make</code> to compile everything.</li><li>Sometimes, we need to manually load cmake module. Use <code>module avail cmake</code> to check the available cmake version and use, e.g., <code>module load cmake/3.12.3</code> to load the new cmake version.</li></ul><h3 id="running-jobs">Running Jobs</h3><ul><li><p>For each project, there will be a corresponding batch file <em>**.sh</em>. For example <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">#SBATCH --account=def-SUPERVISOR</span><br><span class="line">#SBATCH --time=01:00:00</span><br><span class="line">#SBATCH --ntasks=64</span><br><span class="line">#SBATCH --mem-per-cpu=128M</span><br><span class="line">#SBATCH --job-name=JOBNAME</span><br><span class="line">#SBATCH --output=%x-%j-np64.out</span><br><span class="line">#SBATCH --mail-user=EMAILADDRESS</span><br><span class="line">#SBATCH --mail-type=BEGIN</span><br><span class="line">#SBATCH --mail-type=END</span><br><span class="line">#SBATCH --mail-type=FAIL </span><br><span class="line"></span><br><span class="line">mpirun -np 64 ./projectName ./projectName.xml</span><br></pre></td></tr></table></figure></p><ul><li><code>--mail</code> provides the option for notification at different stage of the simulation which is quite useful.</li></ul></li><li><p>make sure everything is included</p><ul><li>output directory created (or automatically created)</li><li>program parameters</li><li>have the modified code compiled (<code>make</code>)</li></ul></li><li><p>submit the job: <code>sbatch ./projectName.sh</code></p><ul><li>you will see <em>Submitted batch job 11315557</em></li></ul></li><li><p>job status: <code>squeue -u $USER</code></p><ul><li>you will see <em>JOBID USER ACCOUNT NAME ST START_TIME TIME_LEFT NODES CPUS GRES MIN_MEM NODELIST (REASON)</em></li></ul></li><li><p>cancel job: <code>scancel JobID</code></p></li><li><p>check the efficiency of the job: <code>seff JobID</code></p></li><li><p>The information of the submitted job, including the output, would be written in the <em>.out</em> files.</p></li></ul><h3 id="file-transfer">File transfer</h3><ul><li>File transfer is normally done by <a href="https://www.globus.org/" target="_blank" rel="noopener">Globus</a>, details can be found <a href="https://docs.computecanada.ca/wiki/Globus" target="_blank" rel="noopener">here</a></li></ul><h3 id="cpu-based-paraview-client-server-visualization">CPU-based ParaView client-server visualization</h3><p>For large data processing, it will be more convenient to handle it on the cluster end, making use of ParaView cliend-server mechanisms.</p><ul><li>check the <a href="https://docs.computecanada.ca/wiki/Visualization#CPU-based_ParaView_client-server_visualization_on_general_purpose_clusters" target="_blank" rel="noopener">Compute Canada Documentation Wiki</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;For my research involving the lattice Boltzmann method, I normally run most of the simulation on the cluster &lt;a href=&quot;https://docs.computecanada.ca/wiki/Graham&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;GRAHAM&lt;/a&gt; of Compute Canada. It is boring and inconvenient to manage the code and the simulation results across my own laptop and the cluster. But still, I am building up my own way to manage everything and try to make it as easy as possible. Here I briefly note down how I organize my codes using Cmake and Git, and what is the routine of running simulation on the cluster.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Research Daily" scheme="http://swang251.github.io/categories/Research-Daily/"/>
    
    
      <category term="Research Daily" scheme="http://swang251.github.io/tags/Research-Daily/"/>
    
      <category term="CAML" scheme="http://swang251.github.io/tags/CAML/"/>
    
      <category term="HPC" scheme="http://swang251.github.io/tags/HPC/"/>
    
  </entry>
  
</feed>
